(t=>{t.YTFeedCarousel=class{constructor(t,e={}){if(this.container=document.getElementById(t),!this.container)throw new Error(`Container with id "${t}" not found`);if(this.apiKey=e.apiKey||"",this.playlistId=e.playlistId||"",this.maxResults=e.maxResults||12,this.currentIndex=0,this.videos=[],this.itemsPerView=3,this.autoPlay=e.autoPlay||!1,this.autoPlayInterval=e.autoPlayInterval||5e3,this.intervalId=null,!this.apiKey||!this.playlistId)throw new Error("API key and playlist ID are required");this.init()}async init(){try{await this.loadVideos(),this.render(),this.bindEvents(),this.updateItemsPerView(),this.autoPlay&&this.startAutoPlay()}catch(t){this.renderError("Failed to load videos. Please check your API key and playlist ID."),console.error("YouTube Carousel Error:",t)}}async loadVideos(){var t=`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${this.playlistId}&key=${this.apiKey}&maxResults=`+this.maxResults,t=await fetch(t);if(!t.ok)throw new Error("HTTP error! status: "+t.status);var t=await t.json(),e=`https://www.googleapis.com/youtube/v3/videos?part=statistics,contentDetails&id=${t.items.map(t=>t.snippet.resourceId.videoId).join(",")}&key=`+this.apiKey;let i=await(await fetch(e)).json();this.videos=t.items.map((t,e)=>{e=i.items[e]||{};return{id:t.snippet.resourceId.videoId,title:t.snippet.title,thumbnail:t.snippet.thumbnails.maxres?.url||t.snippet.thumbnails.high?.url||t.snippet.thumbnails.medium.url,publishedAt:t.snippet.publishedAt,viewCount:e.statistics?.viewCount||"0",duration:e.contentDetails?.duration||"PT0M0S"}})}render(){let i=document.createElement("div");i.className="carousel-track",i.id="carousel-track",this.videos.forEach((t,e)=>{t=this.createVideoElement(t,e);i.appendChild(t)});var t=this.createNavButtons();this.container.innerHTML="",this.container.appendChild(i),this.container.appendChild(t.prev),this.container.appendChild(t.next)}createVideoElement(t,e){var i=document.createElement("div"),s=(i.className="video-item",this.formatNumber(parseInt(t.viewCount))),a=this.formatDuration(t.duration),r=this.timeAgo(new Date(t.publishedAt));return i.innerHTML=`
                <div class="video-thumbnail" data-video-id="${t.id}">
                    <img src="${t.thumbnail}" alt="${t.title}" loading="lazy">
                    <div class="play-button"></div>
                    <div class="video-overlay">
                        <div class="video-title">${t.title}</div>
                        <div class="video-stats">
                            <span>${s} views</span>
                            <span>${r}</span>
                            <span>${a}</span>
                        </div>
                    </div>
                </div>
            `,i}createNavButtons(){var t=document.createElement("button"),e=(t.className="nav-button prev",t.innerHTML='<svg width="17" height="17" viewBox="-1.636 0 10.88 10.88" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" transform="matrix(-1,1.2246467991473532e-16,-1.2246467991473532e-16,-1,0,0)"><path d="m2.083 9.775 -0.723 -0.723 3.464 -3.485L1.36 2.083l0.723 -0.723 4.165 4.208z"></path></svg>',t.addEventListener("click",()=>this.prev()),document.createElement("button"));return e.className="nav-button next",e.innerHTML='<svg width="17" height="17" viewBox="-1.636 0 10.88 10.88" xmlns="http://www.w3.org/2000/svg"><path d="m2.083 9.775 -0.723 -0.723 3.464 -3.485L1.36 2.083l0.723 -0.723 4.165 4.208z"/></svg>',e.addEventListener("click",()=>this.next()),{prev:t,next:e}}bindEvents(){this.container.addEventListener("click",t=>{var t=t.target.closest(".video-thumbnail");t&&(t=t.getAttribute("data-video-id"),this.playVideo(t))}),document.addEventListener("keydown",t=>{"ArrowLeft"===t.key&&this.prev(),"ArrowRight"===t.key&&this.next()});let i=0,s=0;this.container.addEventListener("touchstart",t=>{i=t.touches[0].clientX,s=t.touches[0].clientY}),this.container.addEventListener("touchend",t=>{var e;i&&s&&(e=t.changedTouches[0].clientX,t=t.changedTouches[0].clientY,e=i-e,t=s-t,Math.abs(e)>Math.abs(t)&&50<Math.abs(e)&&(0<e?this.next():this.prev()),i=0,s=0)}),t.addEventListener("resize",()=>{this.updateItemsPerView()}),this.autoPlay&&(this.container.addEventListener("mouseenter",()=>this.stopAutoPlay()),this.container.addEventListener("mouseleave",()=>this.startAutoPlay()))}updateItemsPerView(){var t=this.container.offsetWidth;this.itemsPerView=t<=768?1:t<=1024?2:3,this.container.querySelectorAll(".video-item").forEach(t=>{var e=`calc((100% - ${16*(this.itemsPerView-1)}px) / ${this.itemsPerView})`;t.style.flex="0 0 "+e}),this.updateCarouselPosition()}next(){var t=this.videos.length-this.itemsPerView;this.currentIndex<t?this.currentIndex++:this.currentIndex=0,this.updateCarouselPosition()}prev(){var t=this.videos.length-this.itemsPerView;0<this.currentIndex?this.currentIndex--:this.currentIndex=t,this.updateCarouselPosition()}goToSlide(t){this.currentIndex=t,this.updateCarouselPosition()}updateCarouselPosition(){var t,e=document.getElementById("carousel-track");e&&(t=(this.container.offsetWidth-16*(this.itemsPerView-1))/this.itemsPerView,t=-this.currentIndex*(16+t),e.style.transform=`translateX(${t}px)`)}playVideo(e){var t=this.videos.find(t=>t.id===e);t&&this.createVideoLightbox(t)}createVideoLightbox(t){var e=document.querySelector(".lightbox");e&&e.remove();let i=document.createElement("div");i.className="lightbox";var e=this.formatNumber(parseInt(t.viewCount)),s=this.formatDuration(t.duration),a=this.timeAgo(new Date(t.publishedAt));i.innerHTML=`
                <button class="lightbox-close">&times;</button>
                <div class="lightbox-content">
                    <iframe
                        class="lightbox-video"
                        src="https://www.youtube.com/embed/${t.id}?autoplay=1&rel=0"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                    <div class="lightbox-info">
                        <div class="lightbox-title">${t.title}</div>
                        <div class="lightbox-stats">
                            <span>${e} views</span>
                            <span>${a}</span>
                            <span>${s}</span>
                        </div>
                    </div>
                </div>
            `,document.body.appendChild(i),setTimeout(()=>{i.classList.add("active")},10),i.querySelector(".lightbox-close").addEventListener("click",()=>this.closeLightbox(i)),i.addEventListener("click",t=>{t.target===i&&this.closeLightbox(i)});let r=t=>{"Escape"===t.key&&(this.closeLightbox(i),document.removeEventListener("keydown",r))};document.addEventListener("keydown",r),document.body.style.overflow="hidden"}closeLightbox(t){t.classList.remove("active"),setTimeout(()=>{t.remove(),document.body.style.overflow=""},300)}startAutoPlay(){this.stopAutoPlay(),this.intervalId=setInterval(()=>{var t=Math.ceil(this.videos.length/this.itemsPerView)-1;this.currentIndex>=t?this.currentIndex=0:this.currentIndex++,this.updateCarouselPosition()},this.autoPlayInterval)}stopAutoPlay(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}renderError(t){this.container.innerHTML=`<div class="error">${t}</div>`}formatNumber(t){return 1e6<=t?(t/1e6).toFixed(1)+"M":1e3<=t?(t/1e3).toFixed(1)+"K":t.toString()}formatDuration(t){var t=t.match(/PT(\d+H)?(\d+M)?(\d+S)?/),e=parseInt(t[1])||0,i=parseInt(t[2])||0,t=parseInt(t[3])||0;return 0<e?`${e}:${i.toString().padStart(2,"0")}:`+t.toString().padStart(2,"0"):i+":"+t.toString().padStart(2,"0")}timeAgo(t){var e=new Date,e=Math.abs(e-t),t=Math.floor(e/864e5);return 0===t?"Today":1===t?"1 day ago":t<7?t+" days ago":t<30?Math.floor(t/7)+" weeks ago":t<365?Math.floor(t/30)+" months ago":Math.floor(t/365)+" years ago"}destroy(){this.stopAutoPlay(),t.removeEventListener("resize",this.updateItemsPerView),this.container.innerHTML=""}refresh(){this.init()}}})(window);