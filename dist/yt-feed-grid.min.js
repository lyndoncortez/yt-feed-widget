(t=>{t.YTFeedGrid=class{constructor(t,e={}){if(this.container=document.getElementById(t),!this.container)throw new Error(`Container with id "${t}" not found`);if(this.apiKey=e.apiKey||"",this.playlistId=e.playlistId||"",this.maxResults=e.maxResults||50,this.gridColumns=e.gridColumns||3,this.gridRows=e.gridRows||2,this.showLoadMore=!1!==e.showLoadMore,this.showSubscribe=!1!==e.showSubscribe,this.channelId=e.channelId||"",this.videos=[],this.displayedCount=this.gridColumns*this.gridRows,this.currentOffset=0,!this.apiKey||!this.playlistId)throw new Error("API key and playlist ID are required");this.init()}async init(){try{await this.loadVideos(),await this.loadChannelInfo(),this.render(),this.bindEvents()}catch(t){this.renderError("Failed to load videos. Please check your API key and playlist ID."),console.error("YT Feed Grid Error:",t)}}async loadVideos(){var t=`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${this.playlistId}&key=${this.apiKey}&maxResults=`+this.maxResults,t=await fetch(t);if(!t.ok)throw new Error("HTTP error! status: "+t.status);var t=await t.json(),e=`https://www.googleapis.com/youtube/v3/videos?part=statistics,contentDetails&id=${t.items.map(t=>t.snippet.resourceId.videoId).join(",")}&key=`+this.apiKey;let i=await(await fetch(e)).json();this.videos=t.items.map((t,e)=>{e=i.items[e]||{};return{id:t.snippet.resourceId.videoId,title:t.snippet.title,thumbnail:t.snippet.thumbnails.maxres?.url||t.snippet.thumbnails.high?.url||t.snippet.thumbnails.medium.url,publishedAt:t.snippet.publishedAt,channelTitle:t.snippet.channelTitle,viewCount:e.statistics?.viewCount||"0",duration:e.contentDetails?.duration||"PT0M0S"}}),0<t.items.length&&(this.channelId=t.items[0].snippet.channelId)}async loadChannelInfo(){if(this.channelId)try{var t=`https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics&id=${this.channelId}&key=`+this.apiKey,e=await(await fetch(t)).json();e.items&&0<e.items.length&&(this.channelInfo=e.items[0])}catch(t){}}render(){this.container.innerHTML="",this.container.classList.add("yt-feed-grid");var t=document.createElement("div");t.className="yt-grid-container",t.style.cssText=`
                display: grid;
                grid-template-columns: repeat(${this.gridColumns}, 1fr);
                gap: 20px;
                margin-bottom: 30px;
            `,this.renderVideos(t),this.container.appendChild(t),this.renderActionButtons()}renderVideos(e){this.videos.slice(this.currentOffset,this.currentOffset+this.displayedCount).forEach(t=>{t=this.createVideoElement(t);e.appendChild(t)})}createVideoElement(t){var e=document.createElement("div"),i=(e.className="yt-grid-item",this.formatNumber(parseInt(t.viewCount))),s=this.timeAgo(new Date(t.publishedAt));return e.innerHTML=`
                <div class="yt-grid-thumbnail" data-video-id="${t.id}">
                    <img src="${t.thumbnail}" alt="${t.title}" loading="lazy">
                    <div class="yt-grid-play-button">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                    </div>
                </div>
                <div class="yt-grid-info">
                    <h3 class="yt-grid-title">${t.title}</h3>
                    <div class="yt-grid-meta">
                        <span class="yt-grid-channel">${t.channelTitle}</span>
                        <span class="yt-grid-stats">${i} views â€¢ ${s}</span>
                    </div>
                </div>
            `,e}renderActionButtons(){var t,e=document.createElement("div");e.className="yt-grid-actions",this.showLoadMore&&this.hasMoreVideos()&&((t=document.createElement("button")).className="yt-grid-load-more",t.textContent="Load More...",t.addEventListener("click",()=>this.loadMore()),e.appendChild(t)),this.showSubscribe&&this.channelId&&((t=document.createElement("button")).className="yt-grid-subscribe",t.innerHTML=`
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="white" style="margin-right: 8px;">
                        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136C4.495 20.455 12 20.455 12 20.455s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                    </svg>
                    Subscribe
                `,t.addEventListener("click",()=>this.subscribe()),e.appendChild(t)),0<e.children.length&&this.container.appendChild(e)}loadMore(){this.currentOffset+=this.displayedCount;var t=this.container.querySelector(".yt-grid-container"),t=(this.renderVideos(t),this.container.querySelector(".yt-grid-load-more"));!this.hasMoreVideos()&&t&&(t.style.display="none")}hasMoreVideos(){return this.currentOffset+this.displayedCount<this.videos.length}subscribe(){this.channelId&&t.open(`https://www.youtube.com/channel/${this.channelId}?sub_confirmation=1`,"_blank")}bindEvents(){this.container.addEventListener("click",t=>{var t=t.target.closest(".yt-grid-thumbnail");t&&(t=t.getAttribute("data-video-id"),this.playVideo(t))}),t.addEventListener("resize",()=>{this.updateResponsiveGrid()}),this.updateResponsiveGrid()}updateResponsiveGrid(){var e=this.container.querySelector(".yt-grid-container");if(e){var i=this.container.offsetWidth;let t=this.gridColumns;i<=768?t=1:i<=1024&&(t=Math.min(2,this.gridColumns)),e.style.gridTemplateColumns=`repeat(${t}, 1fr)`}}playVideo(e){var t=this.videos.find(t=>t.id===e);t&&this.createVideoLightbox(t)}createVideoLightbox(t){var e=document.querySelector(".yt-lightbox");e&&e.remove();let i=document.createElement("div");i.className="yt-lightbox";var e=this.formatNumber(parseInt(t.viewCount)),s=this.timeAgo(new Date(t.publishedAt));i.innerHTML=`
                <div class="yt-lightbox-content">
                    <button class="yt-lightbox-close">&times;</button>
                    <iframe
                        class="yt-lightbox-video"
                        src="https://www.youtube.com/embed/${t.id}?autoplay=1&rel=0"
                        frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                    <div class="yt-lightbox-info">
                        <div class="yt-lightbox-title">${t.title}</div>
                        <div class="yt-lightbox-stats">
                            <span>${t.channelTitle}</span>
                            <span>${e} views</span>
                            <span>${s}</span>
                        </div>
                    </div>
                </div>
            `,document.body.appendChild(i),setTimeout(()=>{i.classList.add("active")},10),i.querySelector(".yt-lightbox-close").addEventListener("click",()=>this.closeLightbox(i)),i.addEventListener("click",t=>{t.target===i&&this.closeLightbox(i)});let a=t=>{"Escape"===t.key&&(this.closeLightbox(i),document.removeEventListener("keydown",a))};document.addEventListener("keydown",a),document.body.style.overflow="hidden"}closeLightbox(t){t.classList.remove("active"),setTimeout(()=>{t.remove(),document.body.style.overflow=""},300)}renderError(t){this.container.innerHTML=`<div class="yt-grid-error">${t}</div>`}formatNumber(t){return 1e6<=t?(t/1e6).toFixed(1)+"M":1e3<=t?(t/1e3).toFixed(1)+"K":t.toString()}timeAgo(t){var e=new Date,e=Math.abs(e-t),t=Math.floor(e/864e5);return 0===t?"Today":1===t?"1 day ago":t<7?t+" days ago":t<30?Math.floor(t/7)+" weeks ago":t<365?Math.floor(t/30)+" months ago":Math.floor(t/365)+" years ago"}destroy(){t.removeEventListener("resize",this.updateResponsiveGrid),this.container.innerHTML=""}refresh(){this.currentOffset=0,this.init()}}})(window);